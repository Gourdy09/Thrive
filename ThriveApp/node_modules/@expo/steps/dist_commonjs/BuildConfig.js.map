{"version":3,"file":"BuildConfig.js","sourceRoot":"","sources":["../src/BuildConfig.ts"],"names":[],"mappings":"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","sourcesContent":["import assert from 'assert';\nimport fs from 'fs/promises';\nimport path from 'path';\n\nimport Joi from 'joi';\nimport YAML from 'yaml';\n\nimport { BuildConfigError, BuildWorkflowError } from './errors.js';\nimport { BuildRuntimePlatform } from './BuildRuntimePlatform.js';\nimport {\n  BuildStepInputValueTypeWithRequired,\n  BuildStepInputValueTypeName,\n  BuildStepInputValueType,\n} from './BuildStepInput.js';\nimport { BuildStepEnv } from './BuildStepEnv.js';\nimport { BUILD_STEP_OR_BUILD_GLOBAL_CONTEXT_REFERENCE_REGEX } from './utils/template.js';\n\nexport type BuildFunctions = Record<string, BuildFunctionConfig>;\n\ninterface BuildFunctionsConfigFile {\n  configFilesToImport?: string[];\n  functions?: BuildFunctions;\n}\n\nexport interface BuildConfig extends BuildFunctionsConfigFile {\n  build: {\n    name?: string;\n    steps: BuildStepConfig[];\n  };\n}\n\nexport type BuildStepConfig =\n  | BuildStepCommandRun\n  | BuildStepBareCommandRun\n  | BuildStepFunctionCall\n  | BuildStepBareFunctionOrFunctionGroupCall;\n\nexport type BuildStepCommandRun = {\n  run: BuildFunctionCallConfig & {\n    outputs?: BuildStepOutputs;\n    command: string;\n  };\n};\nexport type BuildStepBareCommandRun = { run: string };\nexport type BuildStepFunctionCall = {\n  [functionId: string]: BuildFunctionCallConfig;\n};\nexport type BuildStepBareFunctionOrFunctionGroupCall = string;\n\nexport type BuildFunctionCallConfig = {\n  id?: string;\n  inputs?: BuildStepInputs;\n  name?: string;\n  workingDirectory?: string;\n  shell?: string;\n  env?: BuildStepEnv;\n  if?: string;\n};\n\nexport type BuildStepInputs = Record<string, BuildStepInputValueTypeWithRequired>;\nexport type BuildStepOutputs = (\n  | string\n  | {\n      name: string;\n      required?: boolean;\n    }\n)[];\n\nexport interface BuildFunctionConfig {\n  inputs?: BuildFunctionInputs;\n  outputs?: BuildFunctionOutputs;\n  name?: string;\n  supportedRuntimePlatforms?: BuildRuntimePlatform[];\n  shell?: string;\n  command?: string;\n  path?: string;\n}\n\nexport type BuildFunctionInputs = (\n  | string\n  | {\n      name: string;\n      defaultValue?: BuildStepInputValueType;\n      allowedValues?: BuildStepInputValueType[];\n      required?: boolean;\n      allowedValueType: BuildStepInputValueTypeName;\n    }\n)[];\nexport type BuildFunctionOutputs = BuildStepOutputs;\n\nconst BuildFunctionInputsSchema = Joi.array().items(\n  Joi.alternatives().conditional(Joi.ref('.'), {\n    is: Joi.string(),\n    then: Joi.string().required(),\n    otherwise: Joi.object({\n      name: Joi.string().required(),\n      defaultValue: Joi.when('allowedValues', {\n        is: Joi.exist(),\n        then: Joi.valid(Joi.in('allowedValues')).messages({\n          'any.only': '{{#label}} must be one of allowed values',\n        }),\n      })\n        .when('allowedValueType', {\n          is: BuildStepInputValueTypeName.STRING,\n          then: Joi.string().allow(''),\n        })\n        .when('allowedValueType', {\n          is: BuildStepInputValueTypeName.BOOLEAN,\n          then: Joi.alternatives(\n            Joi.boolean(),\n            Joi.string().pattern(\n              BUILD_STEP_OR_BUILD_GLOBAL_CONTEXT_REFERENCE_REGEX,\n              'context or output reference regex pattern'\n            )\n          ).messages({\n            'alternatives.types':\n              '{{#label}} must be a boolean or reference to output or context value',\n          }),\n        })\n        .when('allowedValueType', {\n          is: BuildStepInputValueTypeName.NUMBER,\n          then: Joi.alternatives(\n            Joi.number(),\n            Joi.string().pattern(\n              BUILD_STEP_OR_BUILD_GLOBAL_CONTEXT_REFERENCE_REGEX,\n              'context or output reference regex pattern'\n            )\n          ).messages({\n            'alternatives.types':\n              '{{#label}} must be a number or reference to output or context value',\n          }),\n        })\n        .when('allowedValueType', {\n          is: BuildStepInputValueTypeName.JSON,\n          then: Joi.alternatives(\n            Joi.object(),\n            Joi.string().pattern(\n              BUILD_STEP_OR_BUILD_GLOBAL_CONTEXT_REFERENCE_REGEX,\n              'context or output reference regex pattern'\n            )\n          ).messages({\n            'alternatives.types':\n              '{{#label}} must be a object or reference to output or context value',\n          }),\n        }),\n      allowedValues: Joi.when('allowedValueType', {\n        is: BuildStepInputValueTypeName.STRING,\n        then: Joi.array().items(Joi.string().allow('')),\n      })\n        .when('allowedValueType', {\n          is: BuildStepInputValueTypeName.BOOLEAN,\n          then: Joi.array().items(Joi.boolean()),\n        })\n        .when('allowedValueType', {\n          is: BuildStepInputValueTypeName.NUMBER,\n          then: Joi.array().items(Joi.number()),\n        })\n        .when('allowedValueType', {\n          is: BuildStepInputValueTypeName.JSON,\n          then: Joi.array().items(Joi.object()),\n        }),\n      allowedValueType: Joi.string()\n        .valid(...Object.values(BuildStepInputValueTypeName))\n        .default(BuildStepInputValueTypeName.STRING),\n      required: Joi.boolean(),\n    })\n      .rename('allowed_values', 'allowedValues')\n      .rename('default_value', 'defaultValue')\n      .rename('type', 'allowedValueType')\n      .required(),\n  })\n);\n\nconst BuildStepOutputsSchema = Joi.array().items(\n  Joi.alternatives().try(\n    Joi.string().required(),\n    Joi.object({\n      name: Joi.string().required(),\n      required: Joi.boolean(),\n    }).required()\n  )\n);\n\nconst BuildFunctionCallSchema = Joi.object({\n  id: Joi.string(),\n  inputs: Joi.object().pattern(\n    Joi.string(),\n    Joi.alternatives().try(Joi.string().allow(''), Joi.boolean(), Joi.number(), Joi.object())\n  ),\n  name: Joi.string(),\n  workingDirectory: Joi.string(),\n  shell: Joi.string(),\n  env: Joi.object().pattern(Joi.string(), Joi.string().allow('')),\n  if: Joi.string(),\n}).rename('working_directory', 'workingDirectory');\n\nconst BuildStepConfigSchema = Joi.any<BuildStepConfig>()\n  .invalid(null)\n  .when(\n    Joi.object().pattern(\n      Joi.string().disallow('run').required(),\n      Joi.object().unknown().required()\n    ),\n    {\n      then: Joi.object().pattern(\n        Joi.string().disallow('run').min(1).required(),\n        BuildFunctionCallSchema.required(),\n        { matches: Joi.array().length(1) }\n      ),\n    }\n  )\n  .when(Joi.object({ run: Joi.object().unknown().required() }), {\n    then: Joi.object({\n      run: BuildFunctionCallSchema.keys({\n        outputs: BuildStepOutputsSchema,\n        command: Joi.string().required(),\n      }),\n    }),\n  })\n  .when(Joi.object({ run: Joi.string().required() }), {\n    then: Joi.object({\n      run: Joi.string().min(1).required(),\n    }),\n  })\n  .when(Joi.string(), {\n    then: Joi.string().min(1),\n  });\n\nconst BuildFunctionConfigSchema = Joi.object({\n  name: Joi.string(),\n  supportedRuntimePlatforms: Joi.array().items(...Object.values(BuildRuntimePlatform)),\n  inputs: BuildFunctionInputsSchema,\n  outputs: BuildStepOutputsSchema,\n  command: Joi.string(),\n  path: Joi.string(),\n  shell: Joi.string(),\n})\n  .rename('supported_platforms', 'supportedRuntimePlatforms')\n  .xor('command', 'path')\n  .nand('command', 'path');\n\nexport const BuildFunctionsConfigFileSchema = Joi.object<BuildFunctionsConfigFile>({\n  configFilesToImport: Joi.array().items(Joi.string().pattern(/\\.y(a)?ml$/)),\n  functions: Joi.object().pattern(\n    Joi.string()\n      .pattern(/^[\\w-]+$/, 'function names')\n      .min(1)\n      .required()\n      .disallow('run'),\n    BuildFunctionConfigSchema.required()\n  ),\n})\n  .rename('import', 'configFilesToImport')\n  .required();\n\nexport const BuildConfigSchema = BuildFunctionsConfigFileSchema.append<BuildConfig>({\n  build: Joi.object({\n    name: Joi.string(),\n    steps: Joi.array().items(BuildStepConfigSchema.required()).required(),\n  }).required(),\n}).required();\n\ninterface BuildConfigValidationParams {\n  externalFunctionIds?: string[];\n  externalFunctionGroupsIds?: string[];\n  skipNamespacedFunctionsOrFunctionGroupsCheck?: boolean;\n}\n\nexport async function readAndValidateBuildConfigFromPathAsync(\n  configPath: string,\n  params: BuildConfigValidationParams = {}\n): Promise<BuildConfig> {\n  const rawConfig = await readRawBuildConfigAsync(configPath);\n\n  const config = validateConfig(BuildConfigSchema, rawConfig);\n  for (const functionName in config.functions) {\n    const customFunctionPath = config.functions[functionName].path;\n    if (customFunctionPath) {\n      config.functions[functionName].path = maybeResolveCustomFunctionRelativePath(\n        path.dirname(configPath),\n        customFunctionPath\n      );\n    }\n  }\n\n  const importedFunctions = await importFunctionsAsync(configPath, config.configFilesToImport);\n  mergeConfigWithImportedFunctions(config, importedFunctions);\n  validateAllFunctionsExist(config, params);\n  return config;\n}\n\nasync function importFunctionsAsync(\n  baseConfigPath: string,\n  configPathsToImport?: string[]\n): Promise<BuildFunctions> {\n  if (!configPathsToImport) {\n    return {};\n  }\n\n  const baseConfigDir = path.dirname(baseConfigPath);\n\n  const errors: BuildConfigError[] = [];\n  const importedFunctions: BuildFunctions = {};\n  // this is a set of visited files identified by ABSOLUTE paths\n  const visitedFiles = new Set<string>([baseConfigPath]);\n  const configFilesToVisit = (configPathsToImport ?? []).map((childConfigRelativePath) =>\n    path.resolve(baseConfigDir, childConfigRelativePath)\n  );\n  while (configFilesToVisit.length > 0) {\n    const childConfigPath = configFilesToVisit.shift();\n    assert(childConfigPath, 'Guaranteed by loop condition');\n    if (visitedFiles.has(childConfigPath)) {\n      continue;\n    }\n    visitedFiles.add(childConfigPath);\n    try {\n      const childConfig = await readAndValidateBuildFunctionsConfigFileAsync(childConfigPath);\n      const childDir = path.dirname(childConfigPath);\n      for (const functionName in childConfig.functions) {\n        if (!(functionName in importedFunctions)) {\n          const f = childConfig.functions[functionName];\n          if (f.path) {\n            f.path = maybeResolveCustomFunctionRelativePath(childDir, f.path);\n          }\n          importedFunctions[functionName] = f;\n        }\n      }\n      if (childConfig.configFilesToImport) {\n        configFilesToVisit.push(\n          ...childConfig.configFilesToImport.map((relativePath) =>\n            path.resolve(childDir, relativePath)\n          )\n        );\n      }\n    } catch (err) {\n      if (err instanceof BuildConfigError) {\n        errors.push(err);\n      } else {\n        throw err;\n      }\n    }\n  }\n  if (errors.length > 0) {\n    throw new BuildWorkflowError(`Detected build config errors in imported files.`, errors);\n  }\n  return importedFunctions;\n}\n\nexport async function readAndValidateBuildFunctionsConfigFileAsync(\n  configPath: string\n): Promise<BuildFunctionsConfigFile> {\n  const rawConfig = await readRawBuildConfigAsync(configPath);\n  return validateConfig(BuildFunctionsConfigFileSchema, rawConfig);\n}\n\nexport async function readRawBuildConfigAsync(configPath: string): Promise<any> {\n  const contents = await fs.readFile(configPath, 'utf-8');\n  return YAML.parse(contents);\n}\n\nexport function validateConfig<T>(\n  schema: Joi.ObjectSchema<T>,\n  config: object,\n  configFilePath?: string\n): T {\n  const { error, value } = schema.validate(config, {\n    allowUnknown: false,\n    abortEarly: false,\n  });\n  if (error) {\n    const errorMessage = error.details.map(({ message }) => message).join(', ');\n    throw new BuildConfigError(errorMessage, {\n      cause: error,\n      ...(configFilePath && { metadata: { configFilePath } }),\n    });\n  }\n  return value;\n}\n\nexport function mergeConfigWithImportedFunctions(\n  config: BuildConfig,\n  importedFunctions: BuildFunctions\n): void {\n  if (Object.keys(importedFunctions).length === 0) {\n    return;\n  }\n  config.functions = config.functions ?? {};\n  for (const functionName in importedFunctions) {\n    if (!(functionName in config.functions)) {\n      config.functions[functionName] = importedFunctions[functionName];\n    }\n  }\n}\n\nexport function isBuildStepCommandRun(step: BuildStepConfig): step is BuildStepCommandRun {\n  return Boolean(step) && typeof step === 'object' && typeof step.run === 'object';\n}\n\nexport function isBuildStepBareCommandRun(step: BuildStepConfig): step is BuildStepBareCommandRun {\n  return Boolean(step) && typeof step === 'object' && typeof step.run === 'string';\n}\n\nexport function isBuildStepFunctionCall(step: BuildStepConfig): step is BuildStepFunctionCall {\n  return Boolean(step) && typeof step === 'object' && !('run' in step);\n}\n\nexport function isBuildStepBareFunctionOrFunctionGroupCall(\n  step: BuildStepConfig\n): step is BuildStepBareFunctionOrFunctionGroupCall {\n  return typeof step === 'string';\n}\n\nexport function validateAllFunctionsExist(\n  config: BuildConfig,\n  {\n    externalFunctionIds = [],\n    externalFunctionGroupsIds = [],\n    skipNamespacedFunctionsOrFunctionGroupsCheck,\n  }: BuildConfigValidationParams\n): void {\n  const calledFunctionsOrFunctionGroupsSet = new Set<string>();\n  for (const step of config.build.steps) {\n    if (typeof step === 'string') {\n      calledFunctionsOrFunctionGroupsSet.add(step);\n    } else if (step !== null && !('run' in step)) {\n      const keys = Object.keys(step);\n      assert(\n        keys.length === 1,\n        'There must be at most one function call in the step (enforced by joi).'\n      );\n      calledFunctionsOrFunctionGroupsSet.add(keys[0]);\n    }\n  }\n  const calledFunctionsOrFunctionGroup = Array.from(calledFunctionsOrFunctionGroupsSet);\n  const externalFunctionIdsSet = new Set(externalFunctionIds);\n  const externalFunctionGroupsIdsSet = new Set(externalFunctionGroupsIds);\n  const nonExistentFunctionsOrFunctionGroups = calledFunctionsOrFunctionGroup.filter(\n    (calledFunctionOrFunctionGroup) => {\n      if (\n        isFullIdNamespaced(calledFunctionOrFunctionGroup) &&\n        skipNamespacedFunctionsOrFunctionGroupsCheck\n      ) {\n        return false;\n      }\n      return (\n        !(calledFunctionOrFunctionGroup in (config.functions ?? {})) &&\n        !externalFunctionIdsSet.has(calledFunctionOrFunctionGroup) &&\n        !externalFunctionGroupsIdsSet.has(calledFunctionOrFunctionGroup)\n      );\n    }\n  );\n  if (nonExistentFunctionsOrFunctionGroups.length > 0) {\n    throw new BuildConfigError(\n      `Calling non-existent functions: ${nonExistentFunctionsOrFunctionGroups\n        .map((f) => `\"${f}\"`)\n        .join(', ')}.`\n    );\n  }\n}\n\nfunction maybeResolveCustomFunctionRelativePath(dir: string, customFunctionPath: string): string {\n  if (!path.isAbsolute(customFunctionPath)) {\n    return path.resolve(dir, customFunctionPath);\n  }\n  return customFunctionPath;\n}\n\nfunction isFullIdNamespaced(fullId: string): boolean {\n  return fullId.includes('/');\n}\n"]}