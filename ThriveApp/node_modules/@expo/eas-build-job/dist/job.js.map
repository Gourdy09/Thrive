{"version":3,"file":"job.js","sourceRoot":"","sources":["../src/job.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,8CAAsB;AAEtB,qCAAoC;AACpC,mDAAqC;AAErC,2CAA6B;AAKhB,QAAA,SAAS,GAAG,aAAG,CAAC,MAAM,CAAW;IAC5C,QAAQ,EAAE,aAAG,CAAC,MAAM,EAAE;SACnB,KAAK,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,iBAAQ,CAAC,CAAC;SACjC,QAAQ,EAAE;CACd,CAAC;KACC,IAAI,CAAC,aAAG,CAAC,MAAM,CAAC,EAAE,QAAQ,EAAE,iBAAQ,CAAC,OAAO,EAAE,CAAC,CAAC,OAAO,EAAE,EAAE,EAAE,IAAI,EAAE,OAAO,CAAC,SAAS,EAAE,CAAC;KACvF,IAAI,CAAC,aAAG,CAAC,MAAM,CAAC,EAAE,QAAQ,EAAE,iBAAQ,CAAC,GAAG,EAAE,CAAC,CAAC,OAAO,EAAE,EAAE,EAAE,IAAI,EAAE,GAAG,CAAC,SAAS,EAAE,CAAC,CAAC;AAEnF,SAAgB,gBAAgB,CAAC,MAAc;IAC7C,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,iBAAS,CAAC,QAAQ,CAAC,MAAM,EAAE;QAClD,YAAY,EAAE,IAAI;QAClB,OAAO,EAAE,IAAI;QACb,UAAU,EAAE,KAAK;KAClB,CAAC,CAAC;IAEH,IAAI,KAAK,EAAE,CAAC;QACV,MAAM,KAAK,CAAC;IACd,CAAC;SAAM,CAAC;QACN,MAAM,GAAG,GAAa,KAAK,CAAC;QAC5B,OAAO,GAAG,CAAC;IACb,CAAC;AACH,CAAC;AAbD,4CAaC","sourcesContent":["import Joi from 'joi';\n\nimport { Platform } from './common';\nimport * as Android from './android';\nimport { Generic } from './generic';\nimport * as Ios from './ios';\n\nexport type BuildJob = Android.Job | Ios.Job;\nexport type Job = BuildJob | Generic.Job;\n\nexport const JobSchema = Joi.object<BuildJob>({\n  platform: Joi.string()\n    .valid(...Object.values(Platform))\n    .required(),\n})\n  .when(Joi.object({ platform: Platform.ANDROID }).unknown(), { then: Android.JobSchema })\n  .when(Joi.object({ platform: Platform.IOS }).unknown(), { then: Ios.JobSchema });\n\nexport function sanitizeBuildJob(rawJob: object): BuildJob {\n  const { value, error } = JobSchema.validate(rawJob, {\n    stripUnknown: true,\n    convert: true,\n    abortEarly: false,\n  });\n\n  if (error) {\n    throw error;\n  } else {\n    const job: BuildJob = value;\n    return job;\n  }\n}\n"]}