{"version":3,"names":["_types","require","_Node","_types2","_Enum","_datatypes","_DeclarationContext","PathEffectDeclaration","JsiDeclarationNode","constructor","ctx","type","props","DeclarationType","PathEffect","composeAndPush","pe1","save","decorateChildren","pe2","pathEffects","popAllAsOne","restore","pe","Skia","MakeCompose","push","DiscretePathEffectNode","NodeType","DiscretePathEffect","decorate","length","deviation","seed","MakeDiscrete","exports","Path2DPathEffectNode","Path2DPathEffect","matrix","path","processPath","MakePath2D","Error","DashPathEffectNode","DashPathEffect","intervals","phase","MakeDash","CornerPathEffectNode","CornerPathEffect","r","MakeCorner","SumPathEffectNode","SumPathEffect","pes","popAll","composeDeclarations","MakeSum","bind","Line2DPathEffectNode","Line2DPathEffect","width","MakeLine2D","Path1DPathEffectNode","Path1DPathEffect","advance","style","MakePath1D","Path1DEffectStyle","enumKey"],"sources":["PathEffects.ts"],"sourcesContent":["import { Path1DEffectStyle } from \"../../../skia/types\";\nimport type { SkPathEffect } from \"../../../skia/types\";\nimport type { NodeContext } from \"../Node\";\nimport { JsiDeclarationNode } from \"../Node\";\nimport type {\n  CornerPathEffectProps,\n  DashPathEffectProps,\n  DiscretePathEffectProps,\n  Line2DPathEffectProps,\n  Path1DPathEffectProps,\n  Path2DPathEffectProps,\n} from \"../../types\";\nimport { DeclarationType, NodeType } from \"../../types\";\nimport { enumKey } from \"../datatypes/Enum\";\nimport { processPath } from \"../datatypes\";\nimport type { DeclarationContext } from \"../../types/DeclarationContext\";\nimport { composeDeclarations } from \"../../types/DeclarationContext\";\n\nabstract class PathEffectDeclaration<P> extends JsiDeclarationNode<P> {\n  constructor(ctx: NodeContext, type: NodeType, props: P) {\n    super(ctx, DeclarationType.PathEffect, type, props);\n  }\n\n  protected composeAndPush(ctx: DeclarationContext, pe1: SkPathEffect) {\n    ctx.save();\n    this.decorateChildren(ctx);\n    const pe2 = ctx.pathEffects.popAllAsOne();\n    ctx.restore();\n    const pe = pe2 ? this.Skia.PathEffect.MakeCompose(pe1, pe2) : pe1;\n    ctx.pathEffects.push(pe);\n  }\n}\n\nexport class DiscretePathEffectNode extends PathEffectDeclaration<DiscretePathEffectProps> {\n  constructor(ctx: NodeContext, props: DiscretePathEffectProps) {\n    super(ctx, NodeType.DiscretePathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { length, deviation, seed } = this.props;\n    const pe = this.Skia.PathEffect.MakeDiscrete(length, deviation, seed);\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class Path2DPathEffectNode extends PathEffectDeclaration<Path2DPathEffectProps> {\n  constructor(ctx: NodeContext, props: Path2DPathEffectProps) {\n    super(ctx, NodeType.Path2DPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { matrix } = this.props;\n    const path = processPath(this.Skia, this.props.path);\n    const pe = this.Skia.PathEffect.MakePath2D(matrix, path);\n    if (pe === null) {\n      throw new Error(\"Path2DPathEffectNode: invalid path\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class DashPathEffectNode extends PathEffectDeclaration<DashPathEffectProps> {\n  constructor(ctx: NodeContext, props: DashPathEffectProps) {\n    super(ctx, NodeType.DashPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { intervals, phase } = this.props;\n    const pe = this.Skia.PathEffect.MakeDash(intervals, phase);\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class CornerPathEffectNode extends PathEffectDeclaration<CornerPathEffectProps> {\n  constructor(ctx: NodeContext, props: CornerPathEffectProps) {\n    super(ctx, NodeType.CornerPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { r } = this.props;\n    const pe = this.Skia.PathEffect.MakeCorner(r);\n    if (pe === null) {\n      throw new Error(\"CornerPathEffectNode: couldn't create path effect\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class SumPathEffectNode extends PathEffectDeclaration<null> {\n  constructor(ctx: NodeContext) {\n    super(ctx, NodeType.SumPathEffect, null);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    this.decorateChildren(ctx);\n    const pes = ctx.pathEffects.popAll();\n    const pe = composeDeclarations(\n      pes,\n      this.Skia.PathEffect.MakeSum.bind(this.Skia.PathEffect)\n    );\n    ctx.pathEffects.push(pe);\n  }\n}\n\nexport class Line2DPathEffectNode extends PathEffectDeclaration<Line2DPathEffectProps> {\n  constructor(ctx: NodeContext, props: Line2DPathEffectProps) {\n    super(ctx, NodeType.Line2DPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { width, matrix } = this.props;\n    const pe = this.Skia.PathEffect.MakeLine2D(width, matrix);\n    if (pe === null) {\n      throw new Error(\"Line2DPathEffectNode: could not create path effect\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class Path1DPathEffectNode extends PathEffectDeclaration<Path1DPathEffectProps> {\n  constructor(ctx: NodeContext, props: Path1DPathEffectProps) {\n    super(ctx, NodeType.Path1DPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { advance, phase, style } = this.props;\n    const path = processPath(this.Skia, this.props.path);\n    const pe = this.Skia.PathEffect.MakePath1D(\n      path,\n      advance,\n      phase,\n      Path1DEffectStyle[enumKey(style)]\n    );\n    if (pe === null) {\n      throw new Error(\"Path1DPathEffectNode: could not create path effect\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n"],"mappings":"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"}